#본 코드는 모든 파일을 통합할때 발생하는 메모리 부족문제를 해결하고자 여러개의 파일로 나누어 병합하는 과정에서 사용한 코드임.

import sys

outfile = sys.argv[1] + '_Merged.bed'
data_files = sys.argv[2:]

data_dict = {}

for dfile in data_files:
	dopen = open(dfile)
	dlines = dopen.readlines()
	dopen.close()
	data_dict[dfile] = {}
	for dline in dlines:
		dline = dline.strip('\n').split('\t')
		Chr = dline[0]
		Start = dline[1]
		End = dline[2]
		Value = dline[3:]
		Character = Chr + "\t" + Start + "\t" + End
		data_dict[dfile][Character] = Value

Character_list = data_dict[dfile].keys()


outopen = open(outfile, 'w')
for character in Character_list:
	outopen.write(character)
	for dfile in data_files:
		for i in data_dict[dfile][character]:
			outopen.write('\t' + i)
	outopen.write('\n')
outopen.close()
